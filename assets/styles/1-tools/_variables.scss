/// Make custom properties also available in SCSS.
/// @param {Map} $values - Map of custom properties
/// @param {String} $group (null) - Name of the group
/// @example
/// :root {
///   @include variables((
///     --sizing: border-box,
///   ));
///
///   @include variables((
///     --primary: steelblue,
///   ), color);
///
///   @include variables((
///     --breakpoint-medium: 768px,
///     --breakpoint-large: 960px,
///   ), breakpoint);
/// }
///
/// $__REGISTRY: (
///   --sizing: border-box,
///   --primary: steelblue,
///   --breakpoint-medium: 720px,
///   --breakpoint-large: 960px,
///   color: (
///     primary: steelblue
///   ),
///   breakpoint: (
///     medium: 720px,
///     large: 960px
///   ),
/// );
///
/// :root {
///   --sizing: border-box;
///   --primary: steelblue;
///   --breakpoint-medium: 720px
///   --breakpoint-large: 960px;
/// }
@mixin variables($values, $group: null) {

  // check if a selector is present
  // otherwise use the :root selector
  @if & {
    @each $key, $value in $values {
      #{$key}: #{$value};
    }
  }

  @else {
    :root {
      @each $key, $value in $values {
        #{$key}: #{$value};
      }
    }
  }

  @each $key, $value in $values {
    @include set($key, $value);

    // remove the dashes at the front
    $key: remove-leading-dashes($key);

    // when a group is supplied the mixin will try
    // to group the variables with the given group
    @if $group {
      $index: str-index($key, $group);
      $key: if($index, str-slice($key, str-length($group) + 1), $key);
      $key: remove-leading-dashes($key);
      @include set($group, ($key: $value));
    }

    // otherwise just set the $value with the
    // sliced $key
    @else {
      @include set($key, $value);
    }
  }
}

/// Remove any leading dashes.
/// @param  {String} $string
/// @return {String}
@function remove-leading-dashes($string) {
  @while str-index($string, '-') == 1 {
    $string: str-slice($string, 2);
  }
  @return $string;
}
